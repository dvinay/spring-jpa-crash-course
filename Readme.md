## Spring data jpa ##
- Java provides API for database operation using class-Object concept called Java Persitance API; It is a standard from oracle to perform ORM.
- JPA is part of EJB3 and Java EE.
- JPA comes with specification and API to perform Object and table relation
- ORM is a object relational maping; which is implementation of JPA specification
- example for ORM tools are Hibernate, OpenJPA, EclipseLink etc
- JPA API is set of classes like EntityManager, EntityManagerFactory and provide set of annotations to map java class and instance variable to table in database like @Entity, @Table, @Id, @Column etc
- Without spring data, we need to create a Data Access Object like EmployeeDao interface and it's implementation like EmployeeDaoImpl; which has to use EntityManager (if it's a jpa implementation) or HybernateTemplate (if it's a hybernation vendor) and EntityManagerFactory to perform database opearation. The EntityManagerFactory and EntityManager uses DataSource interface(which uses DriverManagerDataSource) to connect the database.
- Spring data jpa hides the boilerplate code; we no need to write DAO classes or interfaces; We need to define Class same like Table structure and give annotations like @Entity and @Id and create a interface which extends CRUDRepository to provide the basic sql operations as method
- Spring data also provides more functionalities like providing paging and sorting, finder methods etc.

### CRUD Operation ###
- Steps to do crud operations
	- Create Entity or modle(simple POJO) class
	- Create Crud repository interface
	- Configure the Data Source/Data base connection configuration
- Create Entity class similar to table and annotate @Entity, @Table, @Id and @Column
- Create an interface which extends CrudRepository<T, ID extends Serializable>; the crud repository provides basic operations to repository object like create, findOne, findAll, count, save, delete, exist
- add database configuration settings in application.properties file
[ref](https://github.com/dvinay/spring-jpa-crash-course/commit/7db210d4ceadfae8da909d48d2d65aea95c15088	)
- Note: spring JPA doesn't show the query while running the code; you can enable to display the query by adding spring.jpa.show-sql=true in application.properties

### ID Generators ###
- When Id as primary key to select the unique row in datbase table; the primary key is depending on the table configuration.
- JPA provides the generation of Id in 4 different ways
	- GenerationType.AUTO
	- GenerationType.IDENTITY
	- GenerationType.SEQUENCE
	- GenerationType.TABLE
- To configure the above id strategy; we need to add the @GeneratedValue(strategy=GenerationType.AUTO) annotation with generation type
- for AUTO; the JPA provider checks the database what kind of strategy does the database supports identity or sequence or table
- for IDENTITY; the primary key is a auto increment; database will automatically increment for us.
- for SEQUENCE; the primary key uses custom logic for sequence to generate
- Note: mysql don't supports sequences
- for TABLE; persistence provider uses a special table to store the keys and uses that keys as primary key for table; we need to create special table along with entity table

- To use IDENTITY; the table must contain primary key as auto increment like
- create table employee( id int PRIMARY KEY AUTO_INCREMENT, name varchar(20))
- the entity must have @GeneratedValue(strategy=GenerationType.IDENTITY)
[ref](https://github.com/dvinay/spring-jpa-crash-course/commit/0503d7644c747ee0371bd5e16453cfb9a701af89)

- To use TABLE; we have to create a special table/placeholder for to keep the id
```SQL
-- data table
create table employee(
id int PRIMARY KEY,
name varchar(20)
)
-- special table
create table id_gen(
gen_name varchar(60) PRIMARY KEY,
gen_val int(20)
)
```
- here; gen_val is the value generated by hibernate
- to use table generator we need to give the placeholder table name, primary key and value info as annotation @TableGenerator(name="employee_gen", table="id_gen", pkColumnName="gen_name",valueColumnName="gen_val",allocationSize=100)
- we have to map the table in @GeneratedValue like @GeneratedValue(strategy=GenerationType.TABLE, generator="employee_gen")
[ref](https://github.com/dvinay/spring-jpa-crash-course/commit/a8e338bbb0e1f2decc720d668233b10930d896c2)

- Instead of JPA provider Generater strategy, we can develop our own custom strategy; the custom strategy must develop a unique value
	- create a class which implements hibernate IdentifierGenerator
	- overide generate method with custom unique id generation logic
	- to use custom generator using @GenericGenerator and @GeneratedValue
- [ref](https://github.com/dvinay/spring-jpa-crash-course/commit/d1f6d473c794a29386b6273e3455e95f59d44892)
```JAVA
@Entity
public class Student {
	@GenericGenerator(name="student_id", strategy="com.fuppino.springdata.idgenerators.custom.CustomRandomIDGenerator")
	@Id
	@GeneratedValue(generator="student_id")
	private Long id;
	private String name;
	... getter and setter
}
```


















